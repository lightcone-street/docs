The Lightcone API is a RESTful JSON API for interacting with the Lightcone
protocol. It provides endpoints for market data, order
management, position tracking, and trade history.

<CardGroup cols={3}>
  <Card title="Rust SDK" icon="rust" href="https://github.com/lightcone-street/lightcone-sdk/tree/main/rust">
    Rust client for the Lightcone API
  </Card>
  <Card title="TypeScript SDK" icon="js" href="https://github.com/lightcone-street/lightcone-sdk/tree/main/typescript">
    TypeScript client for the Lightcone API
  </Card>
  <Card title="Python SDK" icon="python" href="https://github.com/lightcone-street/lightcone-sdk/tree/main/python">
    Python client for the Lightcone API
  </Card>
</CardGroup>

## Base URL

https://tapi.lightcone.xyz/api

All endpoints are served over HTTPS.

## Authentication

Lightcone uses Solana wallet authentication with JWT session tokens.
Authentication is a two-step process:

1. **Sign a message or transaction** with your Solana wallet
2. **Receive a JWT** returned as an `auth_token` HttpOnly cookie

The JWT is valid for 14 days. Subsequent requests are authenticated
automatically via the cookie - no Authorization header is required.

### Authenticating

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/auth/login_or_register_with_message` | POST | Sign an arbitrary message |
| `/auth/login_or_register_with_transaction` | POST | Sign transaction bytes |
| `/auth/logout` | POST | Clear the session cookie |

Both login endpoints accept:

| Field | Type | Description |
|-------|------|-------------|
| `pubkey_bytes` | `number[]` | Your wallet's public key as a byte array |
| `signature` | `number[]` | ED25519 signature bytes |
| `message` / `transaction` | `number[]` | The signed payload bytes |

On success, the response sets an `auth_token` cookie (HttpOnly, Secure,
SameSite=Lax) containing an RS256 JWT. If the wallet has not been seen
before, an account is created automatically.

> **Note:** Public endpoints (markets, orderbook, price history, trades)
> do not require authentication. Only order submission, cancellation, and
> position queries require an active session.

### Order Signatures

Authentication proves your identity. Order signatures are separate - each
order you submit must include a `signature` field containing a hex-encoded
ED25519 signature over the order parameters, signed by the maker's wallet.
This proves the order was authorized by the wallet owner, independent of
the session.

## Request Format

All request bodies must be JSON with `Content-Type: application/json`.

**Path parameters** are used for resource lookups:
GET /api/markets/{market_pubkey}
GET /api/users/{user_pubkey}/positions
GET /api/orderbook/{orderbook_id}

**Query parameters** are used for filtering and pagination:
GET /api/trades?user_pubkey=...&from=1704067200000&limit=100&cursor=5432
GET /api/price-history?orderbook_id=...&resolution=1h&limit=500

## Response Format

All responses are JSON. Successful responses return the resource directly.
Error responses use this shape:

```json
{
"status": "error",
"message": "Human-readable description",
"code": "MACHINE_READABLE_CODE"
}
```

## Numeric Values

All token amounts and prices are returned as decimal strings, not
numbers. The API scales raw on-chain integers to human-readable values
using each token's decimal precision.

```json
{
"balance": "1.500000",
"price": "0.650000",
"size": "10.000000"
}
```

When submitting orders, amounts are specified as raw integers
(maker_amount, taker_amount).

## Timestamps

All timestamps are in milliseconds (Unix epoch). This includes
created_at, executed_at, candle timestamp fields, and query
parameters like from and to.

## Error Codes

Error responses include a code field for programmatic handling:

| Code | Description |
|------|-------------|
| INVALID_PUBKEY | Public key is malformed or wrong length |
| INVALID_SIGNATURE | Signature verification failed |
| SERVICE_UNAVAILABLE | Exchange engine is unreachable |
| NOT_FOUND | Requested resource does not exist |
| INVALID_ARGUMENT | Request parameter is invalid |

## Pagination

List endpoints use cursor-based pagination:

| Parameter | Type | Description |
|-----------|------|-------------|
| limit | integer | Maximum results to return (endpoint-specific max) |
| cursor | string | Cursor from previous response's next_cursor |

Response:

```json
{
"trades": [...],
"next_cursor": "12345",
"has_more": true,
"limit": 100
}
```
