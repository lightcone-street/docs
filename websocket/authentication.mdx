---
title: "WebSocket Authentication"
description: "Authenticate WebSocket connections for private user streams"
---

## Overview

The Lightcone WebSocket API supports both public and authenticated streams:

| Stream Type | Authentication | Examples |
|-------------|----------------|----------|
| **Public** | Not required | `book_update`, `trades`, `price_history`, `market` |
| **Private** | Required | `user` (orders, fills, balances) |

## Authentication Flow

### 1. Get Auth Token

Sign a message and call the login endpoint:

```bash
POST /api/auth/login_or_register_with_message
{
  "message": "Sign in to Lightcone\n\nTimestamp: 1736456789000",
  "signature_bs58": "<base58 signature>",
  "pubkey_bytes": [<wallet pubkey bytes>],
  "use_embedded_wallet": false
}
```

Extract `auth_token` from the `Set-Cookie` response header.

### 2. Connect with Token

Include the token in the Cookie header:

```
wss://tws.lightcone.xyz/ws
Cookie: auth_token=<your_token>
```

### 3. Subscribe

```json
{
  "method": "subscribe",
  "params": { "type": "user" }
}
```

No wallet address needed - extracted from your JWT.


## Error Responses

### Authentication Required

If you try to subscribe to a user stream without authentication:

```json
{
  "type": "error",
  "version": 0.1,
  "data": {
    "error": "Authentication required for user stream",
    "code": "AUTH_REQUIRED",
    "hint": "Include auth_token cookie when connecting"
  }
}
```

### No Linked Wallet

If your account has no linked Solana wallet:

```json
{
  "type": "error",
  "version": 0.1,
  "data": {
    "error": "User has no linked Solana wallet",
    "code": "NO_LINKED_WALLET"
  }
}
```